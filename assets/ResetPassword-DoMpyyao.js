import{u as E,a as L,r as l,j as e,L as p,C as R,X as F,d as n}from"./index-Cg4_vX4T.js";import{B as $}from"./button-WkCkdKiH.js";import{L as x}from"./lock-DShtJxMZ.js";import{E as g}from"./eye-off-DTJokbsk.js";import{E as j}from"./eye-Dc3gfDeR.js";import{C as z}from"./check-B3LBvKvA.js";import{C as N}from"./circle-alert-CfdErX1L.js";import{L as Z}from"./loader-circle-DbVyN-JX.js";const W=()=>{const{updatePassword:v}=E(),f=L(),[r,P]=l.useState({password:"",confirmPassword:""}),[i,y]=l.useState(!1),[c,C]=l.useState(!1),[d,w]=l.useState(!1),[a,h]=l.useState({}),S=s=>{let t=0;return s.length>=8&&t++,s.length>=12&&t++,/[a-z]/.test(s)&&/[A-Z]/.test(s)&&t++,/\d/.test(s)&&t++,/[^a-zA-Z0-9]/.test(s)&&t++,t<=2?{score:t,label:"Weak",color:"text-red-600",bgColor:"bg-red-600"}:t<=3?{score:t,label:"Fair",color:"text-orange-600",bgColor:"bg-orange-600"}:t<=4?{score:t,label:"Good",color:"text-yellow-600",bgColor:"bg-yellow-600"}:{score:t,label:"Strong",color:"text-brand-green",bgColor:"bg-brand-green"}},o=r.password?S(r.password):null,u=[{label:"At least 8 characters",met:r.password.length>=8},{label:"Contains uppercase letter",met:/[A-Z]/.test(r.password)},{label:"Contains lowercase letter",met:/[a-z]/.test(r.password)},{label:"Contains number",met:/\d/.test(r.password)},{label:"Contains special character",met:/[^a-zA-Z0-9]/.test(r.password)}],k=()=>{const s={};return r.password?r.password.length<8?s.password="Password must be at least 8 characters":u.every(t=>t.met)||(s.password="Password does not meet all requirements"):s.password="Password is required",r.confirmPassword?r.password!==r.confirmPassword&&(s.confirmPassword="Passwords do not match"):s.confirmPassword="Please confirm your password",h(s),Object.keys(s).length===0},A=async s=>{if(s.preventDefault(),!k()){n.error("Please fix the errors in the form");return}w(!0);try{const{error:t}=await v(r.password);if(t){t.message.includes("token")?(n.error("Reset link expired. Please request a new one."),setTimeout(()=>f("/forgot-password"),2e3)):n.error(t.message||"Failed to reset password");return}n.success("Password reset successfully!"),setTimeout(()=>f("/login"),1500)}catch(t){n.error("An unexpected error occurred"),console.error("Password reset error:",t)}finally{w(!1)}},b=(s,t)=>{P(m=>({...m,[s]:t})),a[s]&&h(m=>({...m,[s]:""}))};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-brand-blue via-brand-blue/90 to-brand-green flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(p,{to:"/landing",className:"inline-flex items-center gap-3 mb-6",children:e.jsx("div",{className:"w-16 h-16 bg-white rounded-2xl flex items-center justify-center shadow-xl",children:e.jsx("span",{className:"text-brand-green font-bold text-2xl font-poppins",children:"LU"})})}),e.jsx("h1",{className:"text-4xl font-bold text-white mb-2 font-poppins",children:"Reset Password"}),e.jsx("p",{className:"text-white/80 font-inter",children:"Choose a new password for your account"})]}),e.jsxs(R,{className:"p-8 rounded-3xl shadow-2xl border-0",children:[e.jsxs("form",{onSubmit:A,className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2 font-inter",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(x,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{type:i?"text":"password",value:r.password,onChange:s=>b("password",s.target.value),className:`w-full pl-12 pr-12 py-3 border-2 rounded-xl focus:ring-2 focus:ring-brand-green/20 outline-none transition-all font-inter ${a.password?"border-red-500":"border-slate-200 focus:border-brand-green"}`,placeholder:"••••••••",disabled:d,autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>y(!i),className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600",children:i?e.jsx(g,{className:"w-5 h-5"}):e.jsx(j,{className:"w-5 h-5"})})]}),r.password&&o&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-semibold font-inter",children:"Password Strength"}),e.jsx("span",{className:`text-xs font-semibold ${o.color} font-inter`,children:o.label})]}),e.jsx("div",{className:"h-2 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${o.bgColor} transition-all duration-300`,style:{width:`${o.score/5*100}%`}})})]}),r.password&&e.jsx("div",{className:"mt-3 space-y-1",children:u.map((s,t)=>e.jsxs("div",{className:"flex items-center gap-2 text-xs font-inter",children:[s.met?e.jsx(z,{className:"w-4 h-4 text-brand-green"}):e.jsx(F,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{className:s.met?"text-brand-green":"text-slate-600",children:s.label})]},t))}),a.password&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1 font-inter",children:[e.jsx(N,{className:"w-4 h-4"}),a.password]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2 font-inter",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(x,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{type:c?"text":"password",value:r.confirmPassword,onChange:s=>b("confirmPassword",s.target.value),className:`w-full pl-12 pr-12 py-3 border-2 rounded-xl focus:ring-2 focus:ring-brand-green/20 outline-none transition-all font-inter ${a.confirmPassword?"border-red-500":"border-slate-200 focus:border-brand-green"}`,placeholder:"••••••••",disabled:d,autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>C(!c),className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600",children:c?e.jsx(g,{className:"w-5 h-5"}):e.jsx(j,{className:"w-5 h-5"})})]}),a.confirmPassword&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1 font-inter",children:[e.jsx(N,{className:"w-4 h-4"}),a.confirmPassword]})]}),e.jsx($,{type:"submit",disabled:d,className:"w-full bg-brand-green hover:bg-brand-green/90 text-white py-6 rounded-xl shadow-lg hover:shadow-xl transition-all font-semibold text-base",children:d?e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"w-5 h-5 mr-2 animate-spin"}),"Resetting Password..."]}):e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"w-5 h-5 mr-2"}),"Reset Password"]})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx(p,{to:"/login",className:"text-sm text-brand-blue hover:underline font-semibold font-inter",children:"Back to Sign In"})})]})]})})};export{W as default};
